!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.botamp=e():t.botamp=e()}(this,function(){return function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,n){(function(t){function e(t,e,n){return url=l+t,void 0!=e&&(url+="/"+e),void 0!=n&&(url+="/"+n),url}function n(){u.setRequestHeader("Content-Type","application/vnd.api+json"),u.setRequestHeader("Authorization","Basic "+btoa(f+":")),u.withCredentials=!0}function o(t,e){return body={data:{type:t,attributes:e}},JSON.stringify(body)}function r(){return"botamp_"+p+"_contact_id"}function c(){return localStorage.getItem(r())}function i(t){s.then(function(){u.open("POST",e("contacts")),n(),u.onload=function(){201===u.status&&localStorage.setItem(r(),JSON.parse(u.responseText).data.id)},u.send(o("contacts",t))})}function a(t,r){s.then(function(){u.open("PUT",e("contacts",t)),n(),u.send(o("contacts",r))})}var u,f,p,s,l="https://app.botamp.com/api/v1/";window.onclick=function(t){if(href=t.target.getAttribute("href"),"a"==t.target.tagName.toLowerCase()&&href.includes("m.me/")){var e=c();null!=e&&(t.preventDefault(),document.location.href=href+"?ref="+encodeURIComponent("botamp?btp_cid="+e))}};var d=function(){};d.prototype.load=function(t){f=t,u=new XMLHttpRequest,s=new Promise(function(t,o){u.open("GET",e("me"),!0),u.onload=function(){200==u.status?(p=JSON.parse(u.responseText).data.id,match_contact_id=window.location.href.match(/btp_cid=(\d+)/),null!=match_contact_id&&(u.open("GET",e("contacts",match_contact_id[1]),!0),u.onload=function(){200==u.status&&localStorage.setItem(r(),match_contact_id[1])},n(),u.send()),t()):o()},u.onerror=function(){o()},n(),u.send()}),s.catch(function(t){throw t})},d.prototype.identify=function(){if(1==arguments.length){var t=c();null==t?i(arguments[0]):a(t,arguments[0])}else 2==arguments.length&&a(arguments[0],arguments[1])},d.prototype.track=function(t,r){s.then(function(){u.open("POST",e("contacts",c(),"events")),n(),u.send(o("events",{name:t,properties:r}))})},t.export=new d}).call(e,n(1)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}}])});
//# sourceMappingURL=botamp.min.js.map